# 🔄 多裝置同步功能說明

## 📱 功能介紹

現在您的台灣 50 模擬交易平台支援多裝置同步了！

### 功能特點

- ✅ **跨裝置同步**：在任何裝置上登入相同帳號，都能看到相同的數據
- ✅ **即時同步**：數據會自動同步到雲端，每 30 秒自動檢查更新
- ✅ **安全備份**：數據儲存在 Supabase 雲端，不會因為清除瀏覽器數據而遺失
- ✅ **降級支援**：如果未設定 Supabase，會自動使用本地存儲模式

## 🚀 快速開始

### 方式一：使用雲端同步（推薦）

1. **設定 Supabase**（約 10 分鐘）
   - 查看 [Supabase 設定指南](./SUPABASE_SETUP.md)
   - 按照步驟創建 Supabase 專案並設定環境變數

2. **測試同步**
   - 在裝置 A 上註冊並登入
   - 進行一些交易操作
   - 在裝置 B 上使用相同帳號登入
   - 應該能看到裝置 A 的數據

### 方式二：使用本地存儲（預設）

如果不想設定 Supabase，應用程式會自動使用本地存儲模式：

- ✅ 無需任何設定
- ⚠️ 數據只存在本地瀏覽器
- ⚠️ 無法跨裝置同步
- ⚠️ 清除瀏覽器數據會導致數據遺失

## 📊 同步機制說明

### 自動同步

- **即時保存**：每次用戶操作（交易、登入等）會立即保存到雲端
- **定期同步**：每 30 秒自動從雲端檢查是否有更新
- **本地備份**：同時保存到本地 localStorage 作為備份

### 數據衝突處理

- 如果雲端數據更新時間晚於本地，會自動使用雲端數據
- 本地最新操作會優先保存到雲端
- 確保數據一致性

## 🔍 如何確認同步狀態

### 檢查是否啟用雲端同步

1. **登入頁面**
   - 如果看到 "✓ 雲端同步已啟用" 提示，表示已啟用

2. **瀏覽器控制台**
   ```javascript
   // 打開開發者工具 (F12)
   // 在 Console 輸入：
   console.log('Cloud sync:', !!import.meta.env.VITE_SUPABASE_URL);
   ```

3. **檢查環境變數**
   - 確認已設定 `VITE_SUPABASE_URL` 和 `VITE_SUPABASE_ANON_KEY`

## 🐛 常見問題

### Q1: 為什麼看不到 "✓ 雲端同步已啟用" 提示？

**A:** 這表示 Supabase 未設定或環境變數未生效：
- 檢查 `.env.local` 檔案是否存在且格式正確
- 確認環境變數名稱正確（`VITE_SUPABASE_URL` 和 `VITE_SUPABASE_ANON_KEY`）
- 重新啟動開發伺服器

### Q2: 數據無法同步到其他裝置？

**A:** 檢查以下項目：
- 確認兩台裝置都使用相同帳號登入
- 確認 Supabase 環境變數已正確設定
- 檢查網路連線是否正常
- 查看瀏覽器控制台是否有錯誤

### Q3: 可以同時在多個裝置上使用嗎？

**A:** 可以！但請注意：
- 數據會自動同步，但可能有短暫延遲（最多 30 秒）
- 建議避免同時進行交易操作，以免數據衝突
- 最後的操作會覆蓋之前的操作

### Q4: 如果 Supabase 服務中斷怎麼辦？

**A:** 應用程式會自動降級到本地存儲模式：
- 所有功能正常運作
- 數據保存在本地瀏覽器
- 服務恢復後會自動重新同步

### Q5: 如何從本地模式切換到雲端模式？

**A:** 
1. 設定 Supabase 環境變數
2. 重新啟動應用程式
3. 登入後，本地數據會自動上傳到雲端

## 📚 相關文件

- [Supabase 設定指南](./SUPABASE_SETUP.md) - 詳細的 Supabase 設定步驟
- [環境變數設定指南](./ENV_SETUP.md) - 環境變數設定說明
- [部署指南](./部署指南.md) - 部署時如何設定環境變數

## 🎉 開始使用

現在您可以：
1. 在手機上登入
2. 在電腦上登入
3. 在任何裝置上查看相同的交易記錄和資產狀況

享受多裝置同步的便利吧！
